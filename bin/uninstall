#!/bin/bash

REPO="$(dirname "$(dirname "${0}")")"
. "${REPO}/scripts/pzenv"

SRC="${REPO}/src"

echo You\'re about to uninstall Project Zomboid server tools
echo This will delete all related files and configuration

confirm_yes_no
if [ "${?}" = '0' ]; then
	echo Aborted
	exit
fi

for SCRIPT in $(ls -1 "${REPO}/scripts"); do
	sudo rm -f "${BIN}/${SCRIPT}"
done

sudo rm -f "${CACHE}" "${LOCK}" "${CONFIG}" "${CRONFILE}" "${LOG}"

sudo rm -rf "${ENV}"

if [ -d "${CACHEDIR}" ]; then
	sudo rmdir "${CACHEDIR}"
fi

if [ -d "${CONFIGDIR}" ]; then
	sudo rmdir "${CONFIGDIR}"
fi

cd "${SRC}"

sudo make uninstall > /dev/null

echo OK
